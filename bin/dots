#!/usr/bin/env bash

dotfiles_dir=$HOME/.config/dotfiles
target_dir=$HOME
packets=$(ls -1 $source_dir)

[ ! -d "$target_dir" ] && mkdir -p "$target_dir"

case "$1" in
  m*)
    shift
    if [ -z "$@" ]; then
      stow --dir=$dotfiles_dir --target=$target_dir --verbose --stow $packets
    else
      stow --dir=$dotfiles_dir --target=$target_dir --verbose --stow $@
    fi
    ;;

  u*)
    shift
    if [ -z "$@" ]; then
      stow --dir=$dotfiles_dir --target=$target_dir --verbose --delete $packets
    else
      stow --dir=$dotfiles_dir --target=$target_dir --verbose --delete $@
    fi
    ;;

  r*)
    shift
    if [ -z "$@" ]; then
      stow --dir=$dotfiles_dir --target=$target_dir --verbose --restow $packets
    else
      stow --dir=$dotfiles_dir --target=$target_dir --verbose --restow $@
    fi
    ;;

  *)
    >&2 echo "usage: dots [mount|umount|remount|help]"
    ;;
esac
